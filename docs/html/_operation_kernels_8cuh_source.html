<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeuZephyr: D:/Users/Mgepahmge/Documents/C Program/NeuZephyr/include/NeuZephyr/OperationKernels.cuh Source File</title>
<link rel="icon" href="NZ_logo2.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="NZ_logo2.png"/></td>
  <td id="projectalign">
   <div id="projectname">NeuZephyr
   </div>
   <div id="projectbrief">Simple DL Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_a7e6ee1ae3f772c9504a0b543f2027e2.html">Mgepahmge</a></li><li class="navelem"><a class="el" href="dir_e03f57e346cc4845a4c354a35630b169.html">Documents</a></li><li class="navelem"><a class="el" href="dir_231a0482af2b83c895f27ba7fe745141.html">C Program</a></li><li class="navelem"><a class="el" href="dir_0fa7fc3a0dfd304dbfc9dce9f6facfa2.html">NeuZephyr</a></li><li class="navelem"><a class="el" href="dir_e7295b03dab2e9cdf32139bd8ec2e607.html">include</a></li><li class="navelem"><a class="el" href="dir_657344ecc65cfc28732701509f8d8421.html">NeuZephyr</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">OperationKernels.cuh</div></div>
</div><!--header-->
<div class="contents">
<a href="_operation_kernels_8cuh.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#ifndef OPERATIONKERNELS_CUH</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#define OPERATIONKERNELS_CUH</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &quot;stdio.h&quot;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;utils.cuh&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#define TILE_SIZE 32</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#define FULL_MASK 0xffffffffu</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#define WARP_SIZE 32</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#define MMA 16</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#define CEIL(X) (((X) + 15) &amp; ~15)</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacenz_1_1krnl.html">nz::krnl</a> {</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="preprocessor">#ifdef __CUDACC__</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keywordtype">void</span> MatrixAdd(dim3 gridDim, dim3 blockDim, <span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keyword">const</span> <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span>* c, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="keywordtype">void</span> MatrixSub(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keyword">const</span> <span class="keywordtype">float</span>* a, <span class="keyword">const</span> <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span>* c,</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="keywordtype">void</span> GeneralMatrixMul(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keyword">const</span> <span class="keywordtype">float</span>* A, <span class="keyword">const</span> <span class="keywordtype">float</span>* B, <span class="keywordtype">float</span>* C,</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> M,</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> N,</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> K);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keywordtype">void</span> Transpose(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keyword">const</span> <span class="keywordtype">float</span>* d_A, <span class="keywordtype">float</span>* d_B,</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rows,</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cols);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <span class="keywordtype">void</span> ScalarMul(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in, <span class="keyword">const</span> <span class="keywordtype">float</span> num,</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="keywordtype">void</span> ScalarDiv(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in, <span class="keyword">const</span> <span class="keywordtype">float</span> num,</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="keywordtype">void</span> ScalarAdd(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in, <span class="keyword">const</span> <span class="keywordtype">float</span> num,</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <span class="keywordtype">void</span> Negation(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="keywordtype">void</span> Recip(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <span class="keywordtype">void</span> RectifiedLinearUnit(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in,</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <span class="keywordtype">void</span> ReLUBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* A_grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* A, <span class="keyword">const</span> <span class="keywordtype">float</span>* B_grad,</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="keywordtype">void</span> Sigmoid(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in,</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="keywordtype">void</span> SigmoidBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* A_grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* B, <span class="keyword">const</span> <span class="keywordtype">float</span>* B_grad,</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    <span class="keywordtype">void</span> Tanh(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in,</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <span class="keywordtype">void</span> TanhBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* A_grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* B, <span class="keyword">const</span> <span class="keywordtype">float</span>* B_grad,</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="keywordtype">void</span> LeakyReLU(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in,</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n, <span class="keyword">const</span> <span class="keywordtype">float</span> alpha = 0.01f);</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <span class="keywordtype">void</span> LeakyReLUBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* A_grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* A, <span class="keyword">const</span> <span class="keywordtype">float</span>* B_grad,</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>                           <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n,</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>                           <span class="keywordtype">float</span> alpha = 0.01f);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    <span class="keywordtype">void</span> Swish(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in,</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    <span class="keywordtype">void</span> SwishBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* A_grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* A, <span class="keyword">const</span> <span class="keywordtype">float</span>* B,</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                       <span class="keyword">const</span> <span class="keywordtype">float</span>* B_grad, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="keywordtype">void</span> ExponentialLinearUnit(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in,</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>                               <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n, <span class="keywordtype">float</span> alpha = 1.0f);</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <span class="keywordtype">void</span> ELUBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* A_grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* A, <span class="keyword">const</span> <span class="keywordtype">float</span>* B_grad,</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>                     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n,</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>                     <span class="keywordtype">float</span> alpha = 1.0f);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span> </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="keywordtype">void</span> HardSigmoid(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in,</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n, <span class="keyword">const</span> <span class="keywordtype">float</span> alpha = 0.2f, <span class="keyword">const</span> <span class="keywordtype">float</span> beta = 0.5f);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <span class="keywordtype">void</span> HardSigmoidBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* A_grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* A,</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>                             <span class="keyword">const</span> <span class="keywordtype">float</span>* B_grad, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n,</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>                             <span class="keywordtype">float</span> alpha = 0.2f, <span class="keywordtype">float</span> beta = 0.5f);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    <span class="keywordtype">void</span> HardSwish(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n,</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>                   <span class="keywordtype">float</span> alpha = 0.2f, <span class="keywordtype">float</span> beta = 0.5f);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    <span class="keywordtype">void</span> HardSwishBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* A_grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* A, <span class="keyword">const</span> <span class="keywordtype">float</span>* B_grad,</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                           <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n,</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                           <span class="keywordtype">float</span> alpha = 0.2f, <span class="keywordtype">float</span> beta = 0.5f);</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    <span class="keywordtype">void</span> SummationExp(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keyword">const</span> <span class="keywordtype">size_t</span> sharedMemSize, <span class="keywordtype">float</span>* out,</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                      <span class="keyword">const</span> <span class="keywordtype">float</span>* g_data,</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span> </div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    <span class="keywordtype">void</span> Softmax(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in, <span class="keyword">const</span> <span class="keywordtype">float</span> exp_sum_of_input,</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    <span class="keywordtype">void</span> SoftmaxJacobian(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* in,</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    <span class="keywordtype">void</span> MeanSquaredError(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keyword">const</span> <span class="keywordtype">size_t</span> sharedMemSize, <span class="keywordtype">float</span>* out,</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>                          <span class="keyword">const</span> <span class="keywordtype">float</span>* predict, <span class="keyword">const</span> <span class="keywordtype">float</span>* real, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <span class="keywordtype">void</span> MSEBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* predict,</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>                     <span class="keyword">const</span> <span class="keywordtype">float</span>* real, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    <span class="keywordtype">void</span> StochasticGradientDescent(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* data, <span class="keyword">const</span> <span class="keywordtype">float</span>* grad,</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>                                   <span class="keyword">const</span> <span class="keywordtype">float</span> lr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span> </div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>    <span class="keywordtype">void</span> BinaryCrossEntropy(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keyword">const</span> <span class="keywordtype">size_t</span> sharedMemSize, <span class="keywordtype">float</span>* out,</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>                            <span class="keyword">const</span> <span class="keywordtype">float</span>* predict, <span class="keyword">const</span> <span class="keywordtype">float</span>* real, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>    <span class="keywordtype">void</span> BCEBackward(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* out, <span class="keyword">const</span> <span class="keywordtype">float</span>* predict,</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>                     <span class="keyword">const</span> <span class="keywordtype">float</span>* real, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span> </div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    <span class="keywordtype">void</span> Momentum(dim3 gridDim, dim3 blockDim, <span class="keywordtype">float</span>* output, <span class="keyword">const</span> <span class="keywordtype">float</span>* grad, <span class="keyword">const</span> <span class="keywordtype">float</span>* velocity, <span class="keywordtype">float</span> beta,</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>                  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span> </div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    <span class="keywordtype">void</span> AdaGrad(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* data, <span class="keywordtype">float</span>* G, <span class="keyword">const</span> <span class="keywordtype">float</span>* grad, <span class="keyword">const</span> <span class="keywordtype">float</span> lr,</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>                 <span class="keyword">const</span> <span class="keywordtype">float</span> eps, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <span class="keywordtype">void</span> RMSprop(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* data, <span class="keywordtype">float</span>* v, <span class="keyword">const</span> <span class="keywordtype">float</span>* grad, <span class="keyword">const</span> <span class="keywordtype">float</span> lr,</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>                 <span class="keyword">const</span> <span class="keywordtype">float</span> beta, <span class="keyword">const</span> <span class="keywordtype">float</span> eps, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    <span class="keywordtype">void</span> Adam(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* data, <span class="keywordtype">float</span>* m, <span class="keywordtype">float</span>* v, <span class="keyword">const</span> <span class="keywordtype">float</span>* grad,</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>              <span class="keyword">const</span> <span class="keywordtype">float</span> lr, <span class="keyword">const</span> <span class="keywordtype">float</span> beta1, <span class="keyword">const</span> <span class="keywordtype">float</span> beta2, <span class="keyword">const</span> <span class="keywordtype">float</span> eps, <span class="keyword">const</span> <span class="keywordtype">int</span> t,</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span> </div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    <span class="keywordtype">void</span> NAdam(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* data, <span class="keywordtype">float</span>* m, <span class="keywordtype">float</span>* m_modified, <span class="keywordtype">float</span>* v,</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>               <span class="keyword">const</span> <span class="keywordtype">float</span>* grad, <span class="keyword">const</span> <span class="keywordtype">float</span> lr, <span class="keyword">const</span> <span class="keywordtype">float</span> beta1, <span class="keyword">const</span> <span class="keywordtype">float</span> beta2, <span class="keyword">const</span> <span class="keywordtype">float</span> eps, <span class="keyword">const</span> <span class="keywordtype">int</span> t,</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>    <span class="keywordtype">void</span> AdaDelta(<span class="keyword">const</span> dim3 gridDim, <span class="keyword">const</span> dim3 blockDim, <span class="keywordtype">float</span>* data, <span class="keywordtype">float</span>* acc_delta, <span class="keywordtype">float</span>* acc_grad,</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>                  <span class="keyword">const</span> <span class="keywordtype">float</span>* grad, <span class="keyword">const</span> <span class="keywordtype">float</span> rho, <span class="keyword">const</span> <span class="keywordtype">float</span> eps, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> n);</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    <span class="keywordtype">void</span> TensorCoreGEMM(<span class="keyword">const</span> <span class="keywordtype">float</span>* A, <span class="keyword">const</span> <span class="keywordtype">float</span>* B, <span class="keywordtype">float</span>* C, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> M,</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> N, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> K);</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>}</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span><span class="preprocessor">#endif </span><span class="comment">//OPERATIONKERNELS_CUH</span></div>
<div class="ttc" id="anamespacenz_1_1krnl_html"><div class="ttname"><a href="namespacenz_1_1krnl.html">nz::krnl</a></div><div class="ttdoc">High-Performance CUDA Kernel Implementations for Tensor Computations.</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>

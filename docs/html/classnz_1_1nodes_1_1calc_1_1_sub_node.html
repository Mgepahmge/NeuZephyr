<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeuZephyr: nz::nodes::calc::SubNode Class Reference</title>
<link rel="icon" href="NZ_logo2.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="NZ_logo2.png"/></td>
  <td id="projectalign">
   <div id="projectname">NeuZephyr
   </div>
   <div id="projectbrief">Simple DL Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>nz</b></li><li class="navelem"><a class="el" href="namespacenz_1_1nodes.html">nodes</a></li><li class="navelem"><a class="el" href="namespacenz_1_1nodes_1_1calc.html">calc</a></li><li class="navelem"><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html">SubNode</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classnz_1_1nodes_1_1calc_1_1_sub_node-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">nz::nodes::calc::SubNode Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Represents a subtraction operation node in a computational graph.  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for nz::nodes::calc::SubNode:</div>
<div class="dyncontent">
<div class="center"><img src="classnz_1_1nodes_1_1calc_1_1_sub_node__inherit__graph.png" border="0" usemap="#anz_1_1nodes_1_1calc_1_1_sub_node_inherit__map" alt="Inheritance graph"/></div>
<map name="anz_1_1nodes_1_1calc_1_1_sub_node_inherit__map" id="anz_1_1nodes_1_1calc_1_1_sub_node_inherit__map">
<area shape="rect" title="Represents a subtraction operation node in a computational graph." alt="" coords="5,80,178,107"/>
<area shape="rect" href="classnz_1_1nodes_1_1_node.html" title="Base class for nodes in a neural network or computational graph." alt="" coords="33,5,150,32"/>
<area shape="poly" title=" " alt="" coords="94,48,94,80,89,80,89,48"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for nz::nodes::calc::SubNode:</div>
<div class="dyncontent">
<div class="center"><img src="classnz_1_1nodes_1_1calc_1_1_sub_node__coll__graph.png" border="0" usemap="#anz_1_1nodes_1_1calc_1_1_sub_node_coll__map" alt="Collaboration graph"/></div>
<map name="anz_1_1nodes_1_1calc_1_1_sub_node_coll__map" id="anz_1_1nodes_1_1calc_1_1_sub_node_coll__map">
<area shape="rect" title="Represents a subtraction operation node in a computational graph." alt="" coords="5,80,178,107"/>
<area shape="rect" href="classnz_1_1nodes_1_1_node.html" title="Base class for nodes in a neural network or computational graph." alt="" coords="33,5,150,32"/>
<area shape="poly" title=" " alt="" coords="94,48,94,80,89,80,89,48"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab5c38bfc256e7784a22bb2bdcab7a72d" id="r_ab5c38bfc256e7784a22bb2bdcab7a72d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5c38bfc256e7784a22bb2bdcab7a72d">SubNode</a> (<a class="el" href="classnz_1_1nodes_1_1_node.html">Node</a> *input_left, <a class="el" href="classnz_1_1nodes_1_1_node.html">Node</a> *input_right)</td></tr>
<tr class="memdesc:ab5c38bfc256e7784a22bb2bdcab7a72d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor to initialize a <code><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html" title="Represents a subtraction operation node in a computational graph.">SubNode</a></code> for tensor subtraction.  <br /></td></tr>
<tr class="separator:ab5c38bfc256e7784a22bb2bdcab7a72d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba6a63da4e869f8f0004896d01fe3f1" id="r_a6ba6a63da4e869f8f0004896d01fe3f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ba6a63da4e869f8f0004896d01fe3f1">forward</a> () override</td></tr>
<tr class="memdesc:a6ba6a63da4e869f8f0004896d01fe3f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward pass for the <code><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html" title="Represents a subtraction operation node in a computational graph.">SubNode</a></code> to perform tensor subtraction.  <br /></td></tr>
<tr class="separator:a6ba6a63da4e869f8f0004896d01fe3f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb396a092ac9fb09c3a656329132842d" id="r_abb396a092ac9fb09c3a656329132842d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abb396a092ac9fb09c3a656329132842d">backward</a> () override</td></tr>
<tr class="memdesc:abb396a092ac9fb09c3a656329132842d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backward pass for the <code><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html" title="Represents a subtraction operation node in a computational graph.">SubNode</a></code> to propagate gradients.  <br /></td></tr>
<tr class="separator:abb396a092ac9fb09c3a656329132842d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classnz_1_1nodes_1_1_node"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classnz_1_1nodes_1_1_node')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classnz_1_1nodes_1_1_node.html">nz::nodes::Node</a></td></tr>
<tr class="memitem:a687ee9c34eb61f8f28caa201ca42696e inherit pub_methods_classnz_1_1nodes_1_1_node" id="r_a687ee9c34eb61f8f28caa201ca42696e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnz_1_1nodes_1_1_node.html#a687ee9c34eb61f8f28caa201ca42696e">print</a> (std::ostream &amp;os) const</td></tr>
<tr class="memdesc:a687ee9c34eb61f8f28caa201ca42696e inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the type, data, and gradient of the node.  <br /></td></tr>
<tr class="separator:a687ee9c34eb61f8f28caa201ca42696e inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b85913e12422bb4ac2fff483427bb47 inherit pub_methods_classnz_1_1nodes_1_1_node" id="r_a9b85913e12422bb4ac2fff483427bb47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnz_1_1nodes_1_1_node.html#a9b85913e12422bb4ac2fff483427bb47">dataInject</a> (Tensor::value_type *data, bool grad=false) const</td></tr>
<tr class="memdesc:a9b85913e12422bb4ac2fff483427bb47 inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="mdescLeft">&#160;</td><td class="mdescRight">Injects data into a relevant tensor object, optionally setting its gradient requirement.  <br /></td></tr>
<tr class="separator:a9b85913e12422bb4ac2fff483427bb47 inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a609f1730085dd1d31e0ddcbbae48a065 inherit pub_methods_classnz_1_1nodes_1_1_node" id="r_a609f1730085dd1d31e0ddcbbae48a065"><td class="memTemplParams" colspan="2">template&lt;typename Iterator &gt; </td></tr>
<tr class="memitem:a609f1730085dd1d31e0ddcbbae48a065 inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classnz_1_1nodes_1_1_node.html#a609f1730085dd1d31e0ddcbbae48a065">dataInject</a> (Iterator begin, Iterator end, const bool grad=false) const</td></tr>
<tr class="memdesc:a609f1730085dd1d31e0ddcbbae48a065 inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="mdescLeft">&#160;</td><td class="mdescRight">Injects data from an iterator range into the output tensor of the InputNode, optionally setting its gradient requirement.  <br /></td></tr>
<tr class="separator:a609f1730085dd1d31e0ddcbbae48a065 inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b4bab3271df92ca1f0914f7a97b1e8 inherit pub_methods_classnz_1_1nodes_1_1_node" id="r_af8b4bab3271df92ca1f0914f7a97b1e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnz_1_1nodes_1_1_node.html#af8b4bab3271df92ca1f0914f7a97b1e8">dataInject</a> (const std::initializer_list&lt; Tensor::value_type &gt; &amp;data, bool grad=false) const</td></tr>
<tr class="memdesc:af8b4bab3271df92ca1f0914f7a97b1e8 inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="mdescLeft">&#160;</td><td class="mdescRight">Injects data from a std::initializer_list into the output tensor of the <a class="el" href="classnz_1_1nodes_1_1_node.html" title="Base class for nodes in a neural network or computational graph.">Node</a>, optionally setting its gradient requirement.  <br /></td></tr>
<tr class="separator:af8b4bab3271df92ca1f0914f7a97b1e8 inherit pub_methods_classnz_1_1nodes_1_1_node"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Represents a subtraction operation node in a computational graph. </p>
<p>The <code><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html" title="Represents a subtraction operation node in a computational graph.">SubNode</a></code> class performs element-wise subtraction between two input tensors. Unlike scalar-based operations, this node handles tensor-to-tensor subtraction, ensuring compatibility of input shapes and propagating gradients for both input tensors during backpropagation.</p>
<p>Key features:</p><ul>
<li><b>Forward Pass</b>: Computes the element-wise subtraction of two input tensors and stores the result in the <code>output</code> tensor.</li>
<li><b>Backward Pass</b>: Propagates gradients for both input tensors. For the left input tensor, the gradient is directly copied from the <code>output</code> tensor's gradient. For the right input tensor, the gradient is negated before being propagated.</li>
<li><b>Shape Validation</b>: Ensures the shapes of the two input tensors are identical during construction. Mismatched shapes result in an exception.</li>
<li><b>Gradient Management</b>: Tracks whether gradients are required for either of the input tensors, and propagates gradients accordingly.</li>
</ul>
<p>This class is part of the <code><a class="el" href="namespacenz_1_1nodes.html" title="Contains classes and functionality for nodes in a neural network or computational graph.">nz::nodes</a></code> namespace and facilitates tensor-to-tensor subtraction operations in computational graphs.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The left and right input tensors must have the same shape; otherwise, an exception will be thrown.</li>
<li>Gradients are propagated efficiently, with negation applied to the right input tensor's gradient during backpropagation.</li>
</ul>
</dd></dl>
<h3><a class="anchor" id="autotoc_md56"></a>
Usage Example:</h3>
<div class="fragment"><div class="line"><span class="comment">// Example: Using SubNode for tensor subtraction</span></div>
<div class="line">InputNode input1({3, 3}, <span class="keyword">true</span>);  <span class="comment">// Create the first input node with shape {3, 3}</span></div>
<div class="line">InputNode input2({3, 3}, <span class="keyword">true</span>);  <span class="comment">// Create the second input node with shape {3, 3}</span></div>
<div class="line"> </div>
<div class="line">input1.output-&gt;fill(5.0f);  <span class="comment">// Fill the first tensor with value 5.0</span></div>
<div class="line">input2.output-&gt;fill(3.0f);  <span class="comment">// Fill the second tensor with value 3.0</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ab5c38bfc256e7784a22bb2bdcab7a72d">SubNode</a> sub_node(&amp;input1, &amp;input2);  <span class="comment">// Subtract input2 from input1</span></div>
<div class="line">sub_node.forward();  <span class="comment">// Perform the forward pass</span></div>
<div class="line">sub_node.backward();  <span class="comment">// Propagate gradients in the backward pass</span></div>
<div class="line"> </div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;Output: &quot;</span> &lt;&lt; *sub_node.output &lt;&lt; std::endl;  <span class="comment">// Print the result</span></div>
<div class="ttc" id="aclassnz_1_1nodes_1_1calc_1_1_sub_node_html_ab5c38bfc256e7784a22bb2bdcab7a72d"><div class="ttname"><a href="#ab5c38bfc256e7784a22bb2bdcab7a72d">nz::nodes::calc::SubNode::SubNode</a></div><div class="ttdeci">SubNode(Node *input_left, Node *input_right)</div><div class="ttdoc">Constructor to initialize a SubNode for tensor subtraction.</div><div class="ttdef"><b>Definition</b> <a href="_nodes_8cu_source.html#l00252">Nodes.cu:252</a></div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="#a6ba6a63da4e869f8f0004896d01fe3f1" title="Forward pass for the SubNode to perform tensor subtraction.">forward()</a> for the tensor subtraction computation in the <a class="el" href="#a6ba6a63da4e869f8f0004896d01fe3f1" title="Forward pass for the SubNode to perform tensor subtraction.">forward</a> pass. </dd>
<dd>
<a class="el" href="#abb396a092ac9fb09c3a656329132842d" title="Backward pass for the SubNode to propagate gradients.">backward()</a> for gradient propagation in the <a class="el" href="#abb396a092ac9fb09c3a656329132842d" title="Backward pass for the SubNode to propagate gradients.">backward</a> pass.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>If the shapes of the two input tensors are not identical.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mgepahmge (<a href="https://github.com/Mgepahmge">https://github.com/Mgepahmge</a>)</dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024/12/05 </dd></dl>

<p class="definition">Definition at line <a class="el" href="_nodes_8cuh_source.html#l01787">1787</a> of file <a class="el" href="_nodes_8cuh_source.html">Nodes.cuh</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab5c38bfc256e7784a22bb2bdcab7a72d" name="ab5c38bfc256e7784a22bb2bdcab7a72d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5c38bfc256e7784a22bb2bdcab7a72d">&#9670;&#160;</a></span>SubNode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nz::nodes::calc::SubNode::SubNode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnz_1_1nodes_1_1_node.html">Node</a> *</td>          <td class="paramname"><span class="paramname"><em>input_left</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classnz_1_1nodes_1_1_node.html">Node</a> *</td>          <td class="paramname"><span class="paramname"><em>input_right</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor to initialize a <code><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html" title="Represents a subtraction operation node in a computational graph.">SubNode</a></code> for tensor subtraction. </p>
<p>The constructor initializes a <code><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html" title="Represents a subtraction operation node in a computational graph.">SubNode</a></code>, which performs element-wise subtraction between two input tensors. It validates the shapes of the input tensors to ensure they are compatible for subtraction, establishes connections to the input nodes, and prepares the output tensor for storing the results.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_left</td><td>A pointer to the first input node. Its <code>output</code> tensor is treated as the left operand in the subtraction. </td></tr>
    <tr><td class="paramname">input_right</td><td>A pointer to the second input node. Its <code>output</code> tensor is treated as the right operand in the subtraction.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The constructor validates that the shapes of the two input tensors are identical. If the shapes do not match, an exception is thrown to prevent invalid operations.</li>
<li>The input nodes are added to the <code>inputs</code> vector, establishing their connection in the computational graph.</li>
<li>The <code>output</code> tensor is initialized with the same shape as the input tensors, and its gradient tracking is determined based on the requirements of the input tensors.</li>
<li>The node's type is set to <code>"Sub"</code> to reflect its operation.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The input tensors must have the same shape; mismatched shapes result in an exception.</li>
<li>This node supports automatic gradient tracking if either input tensor requires gradients.</li>
</ul>
</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>If the shapes of the two input tensors are not identical.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a6ba6a63da4e869f8f0004896d01fe3f1" title="Forward pass for the SubNode to perform tensor subtraction.">forward()</a> for the <a class="el" href="#a6ba6a63da4e869f8f0004896d01fe3f1" title="Forward pass for the SubNode to perform tensor subtraction.">forward</a> pass implementation. </dd>
<dd>
<a class="el" href="#abb396a092ac9fb09c3a656329132842d" title="Backward pass for the SubNode to propagate gradients.">backward()</a> for gradient propagation in the <a class="el" href="#abb396a092ac9fb09c3a656329132842d" title="Backward pass for the SubNode to propagate gradients.">backward</a> pass.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mgepahmge (<a href="https://github.com/Mgepahmge">https://github.com/Mgepahmge</a>)</dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024/12/05 </dd></dl>

<p class="definition">Definition at line <a class="el" href="_nodes_8cu_source.html#l00252">252</a> of file <a class="el" href="_nodes_8cu_source.html">Nodes.cu</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abb396a092ac9fb09c3a656329132842d" name="abb396a092ac9fb09c3a656329132842d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb396a092ac9fb09c3a656329132842d">&#9670;&#160;</a></span>backward()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nz::nodes::calc::SubNode::backward </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Backward pass for the <code><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html" title="Represents a subtraction operation node in a computational graph.">SubNode</a></code> to propagate gradients. </p>
<p>The <code><a class="el" href="#abb396a092ac9fb09c3a656329132842d" title="Backward pass for the SubNode to propagate gradients.">backward()</a></code> method computes and propagates the gradients of the loss with respect to both input tensors. For the left input tensor, the gradient is directly copied from the <code>output</code> tensor's gradient. For the right input tensor, the gradient is negated before propagation.</p>
<ul>
<li>If the left input tensor requires gradients, the gradient from the <code>output</code> tensor is directly copied to the gradient tensor of the left input.</li>
<li>If the right input tensor requires gradients, a temporary buffer is allocated, and the gradient of the <code>output</code> tensor is negated using a CUDA kernel (<code>Negation</code>) before being copied to the gradient tensor of the right input.</li>
<li>Temporary GPU memory (<code>n_grad</code>) is managed within the method and is released after use.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Gradient computation is efficient and ensures proper handling for both input tensors.</li>
<li>The negation step for the right input tensor is necessary due to the derivative of subtraction with respect to the right operand being -1.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Proper memory management is ensured by freeing the temporary buffer (<code>n_grad</code>) after use.</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a6ba6a63da4e869f8f0004896d01fe3f1" title="Forward pass for the SubNode to perform tensor subtraction.">forward()</a> for the tensor subtraction computation in the <a class="el" href="#a6ba6a63da4e869f8f0004896d01fe3f1" title="Forward pass for the SubNode to perform tensor subtraction.">forward</a> pass.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mgepahmge (<a href="https://github.com/Mgepahmge">https://github.com/Mgepahmge</a>)</dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024/12/05 </dd></dl>

<p>Implements <a class="el" href="classnz_1_1nodes_1_1_node.html#a0a9ecbaa3d790ba38e8218aca7837fd0">nz::nodes::Node</a>.</p>

<p class="definition">Definition at line <a class="el" href="_nodes_8cu_source.html#l00270">270</a> of file <a class="el" href="_nodes_8cu_source.html">Nodes.cu</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnz_1_1nodes_1_1calc_1_1_sub_node_abb396a092ac9fb09c3a656329132842d_cgraph.png" border="0" usemap="#aclassnz_1_1nodes_1_1calc_1_1_sub_node_abb396a092ac9fb09c3a656329132842d_cgraph" alt=""/></div>
<map name="aclassnz_1_1nodes_1_1calc_1_1_sub_node_abb396a092ac9fb09c3a656329132842d_cgraph" id="aclassnz_1_1nodes_1_1calc_1_1_sub_node_abb396a092ac9fb09c3a656329132842d_cgraph">
<area shape="rect" title="Backward pass for the SubNode to propagate gradients." alt="" coords="5,131,178,173"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#a785cf34395067f425e032d9bd5e1fa20" title="Frees the CUDA device memory pointed to by the given pointer." alt="" coords="226,12,411,55"/>
<area shape="poly" title=" " alt="" coords="130,128,224,76,257,60,259,64,227,81,133,132"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#ab4b2eb422e0e1ee44bdfdc0eb94457ce" title="Returns a reference to the singleton instance of the StreamManager." alt="" coords="459,72,644,115"/>
<area shape="poly" title=" " alt="" coords="178,132,225,124,443,99,444,105,226,129,178,137"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#a97f78a2d43f6e0508c82d4f3b629de96" title="Asynchronously allocates device memory for type&#45;specific data with stream&#45;ordered dependency tracking..." alt="" coords="226,252,411,295"/>
<area shape="poly" title=" " alt="" coords="133,171,227,223,263,242,260,247,224,228,130,176"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#afa38d5c6db0e6b48c8f74ce8ad0df2bc" title="Asynchronously copies data between CUDA device and host memory based on the specified memory copy kin..." alt="" coords="459,205,644,248"/>
<area shape="poly" title=" " alt="" coords="179,166,226,175,444,209,443,214,225,180,178,171"/>
<area shape="rect" href="namespacenz_1_1krnl.html#af7069a420e81babb49b1bc009333d053" title="Kernel function to negate each element of a matrix on the GPU." alt="" coords="256,139,380,165"/>
<area shape="poly" title=" " alt="" coords="178,149,241,149,241,155,178,155"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#abe439fa00c0bd369c0b2345b095ed5af" title="Synchronizes host thread with completion events for a specific data object." alt="" coords="459,5,644,48"/>
<area shape="poly" title=" " alt="" coords="411,28,443,27,444,32,412,33"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#a1de1cf3aadea137faf90a2f9b4b7abe2" title="Acquires CUDA stream from pool using round&#45;robin scheduling." alt="" coords="692,205,878,248"/>
<area shape="poly" title=" " alt="" coords="411,272,523,268,644,257,688,249,689,255,645,263,523,274,411,277"/>
<area shape="poly" title=" " alt="" coords="645,224,677,224,677,229,645,229"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#adb1078a67c6e38932d7d58c2adb05ec0" title="Synchronizes CUDA stream execution until data writes complete." alt="" coords="692,139,878,181"/>
<area shape="poly" title=" " alt="" coords="628,202,692,184,694,189,629,207"/>
<area shape="poly" title=" " alt="" coords="374,136,449,116,450,122,375,141"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#a46ce59b45de432842454aadf00b93791" title="Asynchronously submits a CUDA kernel with stream&#45;ordered dependency management." alt="" coords="459,139,644,181"/>
<area shape="poly" title=" " alt="" coords="381,151,444,154,444,159,381,157"/>
<area shape="poly" title=" " alt="" coords="629,179,694,198,692,203,628,184"/>
<area shape="poly" title=" " alt="" coords="645,157,677,157,677,163,645,163"/>
</map>
</div>

</div>
</div>
<a id="a6ba6a63da4e869f8f0004896d01fe3f1" name="a6ba6a63da4e869f8f0004896d01fe3f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ba6a63da4e869f8f0004896d01fe3f1">&#9670;&#160;</a></span>forward()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nz::nodes::calc::SubNode::forward </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Forward pass for the <code><a class="el" href="classnz_1_1nodes_1_1calc_1_1_sub_node.html" title="Represents a subtraction operation node in a computational graph.">SubNode</a></code> to perform tensor subtraction. </p>
<p>The <code><a class="el" href="#a6ba6a63da4e869f8f0004896d01fe3f1" title="Forward pass for the SubNode to perform tensor subtraction.">forward()</a></code> method computes the element-wise subtraction between the two input tensors. It uses a CUDA kernel to perform the operation efficiently on the GPU, storing the result in the <code>output</code> tensor.</p>
<ul>
<li>A CUDA kernel (<code>MatrixSub</code>) is launched to subtract the elements of the second input tensor (<code>inputs[1]</code>) from the corresponding elements of the first input tensor (<code>inputs[0]</code>).</li>
<li>The grid and block dimensions are calculated dynamically based on the size of the <code>output</code> tensor to ensure optimal GPU parallelism.</li>
<li>The result of the subtraction is stored in the <code>output</code> tensor.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The subtraction operation is performed as <code>output[i] = input_left[i] - input_right[i]</code> for each element.</li>
<li>Ensure the shapes of the input tensors are identical; this is enforced during node construction.</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#abb396a092ac9fb09c3a656329132842d" title="Backward pass for the SubNode to propagate gradients.">backward()</a> for gradient propagation in the <a class="el" href="#abb396a092ac9fb09c3a656329132842d" title="Backward pass for the SubNode to propagate gradients.">backward</a> pass.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mgepahmge (<a href="https://github.com/Mgepahmge">https://github.com/Mgepahmge</a>)</dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024/12/05 </dd></dl>

<p>Implements <a class="el" href="classnz_1_1nodes_1_1_node.html#a8a828c2e91a4aa2a9ab7b94554e4685b">nz::nodes::Node</a>.</p>

<p class="definition">Definition at line <a class="el" href="_nodes_8cu_source.html#l00263">263</a> of file <a class="el" href="_nodes_8cu_source.html">Nodes.cu</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classnz_1_1nodes_1_1calc_1_1_sub_node_a6ba6a63da4e869f8f0004896d01fe3f1_cgraph.png" border="0" usemap="#aclassnz_1_1nodes_1_1calc_1_1_sub_node_a6ba6a63da4e869f8f0004896d01fe3f1_cgraph" alt=""/></div>
<map name="aclassnz_1_1nodes_1_1calc_1_1_sub_node_a6ba6a63da4e869f8f0004896d01fe3f1_cgraph" id="aclassnz_1_1nodes_1_1calc_1_1_sub_node_a6ba6a63da4e869f8f0004896d01fe3f1_cgraph">
<area shape="rect" title="Forward pass for the SubNode to perform tensor subtraction." alt="" coords="5,39,178,81"/>
<area shape="rect" href="namespacenz_1_1krnl.html#ad18a2b0efc0cdfc9cb861396ad4da53f" title="Kernel function to perform matrix subtraction on GPU." alt="" coords="226,47,357,73"/>
<area shape="poly" title=" " alt="" coords="178,57,210,57,210,63,178,63"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#ab4b2eb422e0e1ee44bdfdc0eb94457ce" title="Returns a reference to the singleton instance of the StreamManager." alt="" coords="405,5,590,48"/>
<area shape="poly" title=" " alt="" coords="357,47,389,42,390,47,358,52"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#a46ce59b45de432842454aadf00b93791" title="Asynchronously submits a CUDA kernel with stream&#45;ordered dependency management." alt="" coords="405,72,590,115"/>
<area shape="poly" title=" " alt="" coords="358,68,390,73,389,78,357,73"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#a1de1cf3aadea137faf90a2f9b4b7abe2" title="Acquires CUDA stream from pool using round&#45;robin scheduling." alt="" coords="638,39,824,81"/>
<area shape="poly" title=" " alt="" coords="590,77,622,73,623,78,591,83"/>
<area shape="rect" href="classnz_1_1cu_strm_1_1_stream_manager.html#adb1078a67c6e38932d7d58c2adb05ec0" title="Synchronizes CUDA stream execution until data writes complete." alt="" coords="638,105,824,148"/>
<area shape="poly" title=" " alt="" coords="591,104,623,109,622,114,590,109"/>
</map>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>D:/Users/Mgepahmge/Documents/C Program/NeuZephyr/include/NeuZephyr/<a class="el" href="_nodes_8cuh_source.html">Nodes.cuh</a></li>
<li>D:/Users/Mgepahmge/Documents/C Program/NeuZephyr/src/<a class="el" href="_nodes_8cu_source.html">Nodes.cu</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
